{% include "layout.html" %}
{% block body %}


<div class="flex flex-wrap m-28">
    <div class="w-full px-3">
        <label class="block uppercase tracking-wide text-gray-700 text-2xl font-bold mb-2 " for="grid-first-name">Video Url
        </label>
      <input oninput="perform()" class="appearance-none block w-80 bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500" name="url" id="urlfield" type="text" placeholder="https://url.com/abc.mp4">

      <p class="text-gray-600 text-xs italic">Enter Link of a video</p>
    </div>

    <div class="w-full px-3">
      <label class="block uppercase tracking-wide text-gray-700 text-2xl font-bold mt-2 mb-2" for="grid-first-name">Poster Url
      </label>
    <input oninput="perform()" class="appearance-none block w-80 bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500" name="poster" id="poster" type="text" placeholder="https://url.com/abc.png">

    <p class="text-gray-600 text-xs italic mt-2 mb-2">Enter Link of a poster image</p>
    <img id="img" height="25%" width="25%" src="" alt="Cover" class="mt-2 mb-5">

    <div class="w-full px-3">
      <button id='gif'onclick="gif()" class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded">GIF Mode</button>
    </div>
  </div>

  <div >
  <label class="relative inline-flex items-center cursor-pointer mt-2 mb-2">
    <input onclick="sh()" type="checkbox" value="" class="sr-only peer">
    <div class="w-14 h-7  bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
 
      
   
    <span id="ctext" class="ml-3 text-sm font-medium text-gray-900 dark:text-gray-300" id='toggle'>Custom</span>
  </label>
<div>

  <div class="max-w-sm rounded overflow-hidden shadow-lg ml-20 mt-11" id="custom">
    
    <div class="px-6 py-4">
      <div class="font-bold text-xl mb-2">Custom
      </div>
      <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
        <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
          Height
        </label>
        <input oninput="perform()" class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" id="height"  type="text" placeholder="720">
      </div>
      <div class="w-full md:w-1/2 px-3">
        <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-last-name">
          width
        </label>
        <input oninput="perform()" class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500" id="width"  type="text" placeholder="1080">
      </div>  
    </div>
  </div>


</div>


</div>
<div id='si' class='si rounded-xl' style='position:fixed;  width: 550px; height: 250px; right:100px; margin-top: -30px; '>
  <label class="block uppercase tracking-wide text-gray-700 text-2xl font-bold mb-2 " for="grid-first-name">Preview
  </label>

  <div id="frame" class="frame" style='padding-top: 56.34%; position: relative; overflow: hidden; width: 100%; height: 100%;'>
  </div>
  
</div>

</div>

<div class='mb-20 ml-32 mt-32 pt-14 '>
  <textarea id="message" rows="4" class="block p-2.5 h-32 w-9/12 	 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 light:bg-gray-700 dark:border-gray-600 light:placeholder-gray-400 light:text-black light:focus:ring-blue-500 light:focus:border-blue-500" placeholder="Write your thoughts here..." disabled></textarea>
  </div>

</div>




<script
src="https://code.jquery.com/jquery-3.6.3.js"
integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

<script>
var autoplay;
var mute;
var loop;
var autopause;
var gifmode=false;

  function gif() {


    
    const element = document.getElementById("gif");
    if (element.className == "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded") {
      element.className = "bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded";
       gifmode=false;

       autoplay=false;
       mute=false;
       loop= false;
       autopause=true;
       perform();

    } else {
       gifmode=true;

       autoplay=true;
       mute=true;
       loop= true;
       autopause=false;
       perform();
      
      element.className = "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded";
    }
  }

var fstyle;
var width;
var height;
  function sh(){
    var custom=document.getElementById("custom");
    if (custom.style.display === "none") {
      console.log('on')
      document.getElementById("ctext").innerHTML="Custom"

      fstyle=false;
      perform()
    
      
      custom.style.display = "block";
    } else {
     console.log('off')
     document.getElementById("ctext").innerHTML="Responsive"



      document.getElementById("height").value='100%';
      document.getElementById("width").value='100%';

      fstyle=true;

      perform();


      custom.style.display = "none";
  }
  }

function perform(){
  var link=document.getElementById("urlfield").value;
  var poster=document.getElementById("poster").value;
  document.getElementById("img").src = poster; 

  var height=document.getElementById("height").value;
  var width=document.getElementById("width").value;
  console.log(fstyle)
  


  console.log(height)
  console.log(width)
  console.log(gifmode)
  $.ajax({
    type: "POST",
    url:"/gen",
    data: {"link":link,"poster":poster,"height":height,"width":width,"fstyle":fstyle,"autoplay":autoplay,"autopause":autopause,"mute":mute,"loop":loop,"gifmode":gifmode},
    success: function(response){
      var res = JSON.parse(response);
      console.log(res[1])
      let frame1 =res[0].slice(1,-1)
      let frame2 =res[1].slice(1,-1)

      var ele= document.getElementById("frame")
      while(ele.firstChild) {
        ele.removeChild(ele.firstChild);
    }
      ele.innerHTML +=frame2
      var area=document.getElementById('message')
      area.value=frame1;


    },
    error: function(error){
      console.log(error);
    }
 

  })
  }
</script>


{% endblock body %}